addons:
  apt:
    packages:
    - realpath
language: python
python:
- "3.6"
services: docker
env:
  global:
  - GITHUB_USER=joeblackwaslike
  - GITHUB_ORG=joeblackwaslike
  - DOCKER_USER=joeblackwaslike
  - DOCKER_ORG=joeblackwaslike
  # DOCKER_PASS
  - secure: "Gs//aTTrJFU1i6Zq0132bJKUVRHxMhVpd3cUxWm3bnkKHSgCVqV7D4y8HrKPkJmUHvdGpDq0c6qEL9QJbNovEsmTBBNrX4oHwO1xua3EkTND1aBNgdkeKybdrJoLpit3AFaJsVpIERVEFSmggPHkxSWvX1wiGpsS4ymFUhJrj7biW/4FTe4ky8zZ1X86rrsGu6TNXFkC0jeumpuQcqR6osClFa7qMtUPJdhYaYxnWxVpISzrpjEAegxX6VxcQGwd6tBE72bxupOimAxsjZfSvtHG/41xLBNO5Ww0oqeS+pZ/4y7A/ojbS4TTuYRdGsASdCAitYjPs+RHJr2X+FfBAX8hScr7ttXaHEwaIX2vAOREW4fF2tFrDDYabECfjeg3HUvkPa8W9L+HwBfWsa/eiv3qfnurHZrU7SqUiy3QRvtQZTNfJXkhuq3AG2Lf9bTRVszvT0vYIwDQ3j9h4FZQU8e2HgdC8vsmrDHSPKju8Q30t4Vj/3AfVGcgdmyoxSvScJDbRiWn4uCJ/LLtNiE0LikjzFlBT7CoyEvpnz5u7DRA4TAqViLe9HBq+RFAFi0M8cHtKlDXUO6L33FBuIArQ6DJWrZ/Ql3uLYZK4DHj+9aqV0C03sVuEvgcfMlJKUW8a/iJRipMZFUfdb+4q68X8SElC6+EvIcVD0/HyN6fz0Y="
notifications:
  email:
    on_success: never
    on_failure: always
  slack:
    rooms:
    - secure: "JBnhtpYUlHaGv2+P5ZiMgNkeeABHXGW9Em0F9e3W87Pfrn9X4SpxJHsGagTtSthf7vJ9gkOBlV5g1o05zfWdySx9eVmCv7vbmGtCWvphCZyu0fh7HSCoblkVgi1WJkhPKGN0178pkIikjotl33p48n4R2J2ilNTYVfTfGP1mukajIWpQHhoei+9ntZ/VHEgk8gsRWXmO3g7NMW7VMRONK68Qu0qt1dSl76v54VaG0xveTLZLOgONR6ynapPW/Z52lkj3PyvYc0m6wxXNgKJ8COuC9GtURGt79Y9aYvS+DuSXtJQaqt2bGXJSeEVWYYOT6nU/wl7ogE7OH4OYfIYo9u8NSdFgygT5lOBDVicnL1/8/qcsnEYNUQhHVm9Gaa8/VMMeh//hjecdU9gYhFjf/iv1gY7v/je/HIzkujsytXXkQ75Evfr7rOi8UNhHz9gUz7hpj5L+GuyGFvfbjpf72BVLlOD+APQgHZy2bDDjVX0xYGMZEB1UELjcA2eJvkJQl9CnuNm8rLMf1jc8LkeiXioi2+XzQ1QdTTndQjsp+2yYJx5tM793sxf5hGyIrneoee/U041hteMFY/Xr8QqCALAyswcsMHPXxK1XEIUZ6nTf1z0t9BaK4TGFErZyZdB7ZbNvJ38UOwKHzR9y6PDhR8jEsQEvz2JofffOYUzvRiI="
    on_success: always
    on_failure: always
before_install:
- source scripts/ci/environment.sh
- pip3 install pyinvoke

install: inv docker.build

script: inv test

after_success:
- ci-tag-build
- hub-push
- hub-update-readme

deploy:
  provider: pypi
  user: joeblackwaslike
  password:
    secure: "jyZaLwOJcuBZeDSArM9JjB2zuHBOWfxDmZis3DV31CCrWRZXjI+beF/QrR2i0CxAtFJKRojb4D4tdeLiCT51gt11RR264KtOkuFcoTW8jo1X/w8qrMs7T5ymzhoxO6ia5AV48b1vTJnpE/WPloRCj3zvsZVmdiG4Cbg/b8NrktKqP7sgii3+/mvbEVADvu8MANFdyEJz5pgr/mrspUaXwWaVoBOttA9XS3npaPewhGMpvhzMWbhm1Oslj17AHtvIErF/gv4gcjsvO9vTtA1UEd21FIZUMNIJ95FndTiWZN+mjtZPlp3GQhi/uhxh5AQDAiaYp/JViNK8p0alu7btClUWQ9KJ+131/HkjbIldmf0ooNIwozZJCYLX9jFFZkRX8Q0YuHOzvFEbRFZYFByYLPfixy8o0hVCASGByYkUHmvJpp4rWk43LrDCi+hbg7KxHSqX8SqQS3nBJ6WsBcJs8p9jNIWzsqm1rIzpwHspqkatkqmgU+hTwQ23TzFJUEBt1KENC5DAczRj02ibbbV+o835j+L6QO9+HRTRDnuD6HytjOFEDzO7U7FEh4P00RZRvoe0S9jFhmJXbMYOwVeNHt7NdbFFc514syWQw7Z+DuOk+2PlpxcQ8UrOnBtsNTiJq1L5Y1qtxHp+GuVRWeBWFdmBL6v5kb7BkvlZ1/eLo0U="
  on:
    tags: true