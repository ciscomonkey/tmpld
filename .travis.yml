addons:
  apt:
    packages:
    - realpath
language: python
python:
- "3.6"
services: docker
env:
  global:
  - GITHUB_USER=joeblackwaslike
  - GITHUB_ORG=joeblackwaslike
  - DOCKER_USER=joeblackwaslike
  - DOCKER_ORG=joeblackwaslike
  # DOCKER_PASS
  - secure: "gKtnv0Sm1Swtpt8feNu7oCZRH2IWlG1Zk+Q/G/IAIXhrYc5pqplAHw5yEcomIl3yePBqewPRKaxnKMO6cnIIo68KtGxpc29Meid/2F41OmpislL0abNeUEzVBEbeVZHtwkoFVtD6VCBfnoVW7O+5hluiLXzNLo3jwK9YG34ZJTLazJKII883xOC5nUhmMpPN5K0rfy1tSMQbBATo1VDUTqAO7Dzbq7/luHvJsvtIgzNw2swwNo1CroJ1nZB0fCR4xnwRB4eeKErWrjA/T9W2wHxVw6U0vAXZLSkrfVM/Gy0i9DkDgDBJa3m3f2XV9lSeKz3mcbwvdX1l5ym1vZTimsgECE4LvF1q0QY9zHQUF77oUGa85tPRj/YHo9WSkjOnD2e+NLIs7hVNPpOSBcHP31HR1fNd96nyU3Gjm9NKGVCMVbek9UyFS6Soz1aQc2Me2SAuGPJWLkwg2QZP3UH1J3BZLj9vO8DzjmKvFZsSjxfEpSWVemSJvOFSKWme5qLouueZZBykQl7u2tfpx1wzy6LK3dXD7HbiR3BgddAkHMODHeO50JjAbjVYOgL+bE8fXF7DgJeEEhwdB3L3pkhWGUaSv3Vweq7PxutZYv4LL+GihpkJOA4vSfE8Si1BybQVkA7bTi5wU1l4LNE/pLUT3VE59DQ8Wue3N7Kzx/1mAVQ="
notifications:
  email:
    on_success: never
    on_failure: always
  slack:
    rooms:
    - secure: "TEK184SuHCvG8G1nxCECRGLApT7mr5la3B7pmb7Wa9ecCbhihNY6qfynLj6uV2GBi2iuVq4UhMI6jZ9T0nFrNPniVG9pw4v/oFGXc78Cfw1LZUgjW7PfYaiEKegRPu0TKXp111+1kSWUUS5k/j7ZDfzwNo9jaz6e8dEoit+0N7UDWfws3IXDNU/KFfASHN67ITMoKlBP8xlr+XyNn1DRQvefJUv0GJIUuCuFg0bpqEBmn0DCwK3/DFoVr4v5tT+uR06ZN+4cYJyG6yjarawK0Su8qRbJOKTxCbb1aMCvBagQ5LJvh6MXo7n7fAaWklFJ7Bl/VuvJQQyPPrW+Em6PqVWQcS41wH8G304env1kVhA5HRo8CNUo7g05YFYHH/rUZi1cL5/MTeLWmymKzYoJRy5eG8zGItM0hlSLhmGJFostsd49lc3Jz7DFRVJRYi9lNaGmBSuNB62Hocs2Ylk/X2dR9vb0RTI9hXtEN22q2GeH87er25Ioxeb+skltJygL5Mx24YqYPkndI8pqRiAA13iIkxhdjgvop0Z6YHI4XOhXMJMDzJJIk1vMRfDtRguI+c5OrfOEqgGWmYGkCNP8CpISCpQbl3Bf5GVWdDOVLqdrR2JItLu9QXNFi1KDS/io00lcagyCD7ZCPO68Eo8E0rOGDkAQgE3tFXHaTPa8J0s="
    on_success: always
    on_failure: always
before_install:
- source scripts/ci/environment.sh
- pip3 install pyinvoke

install: inv docker.build

script: inv test

after_success:
- ci-tag-build
- hub-push
- hub-update-readme

deploy:
  provider: pypi
  user: joeblackwaslike
  password:
    secure: "b2jz3qoBZ5NEOvd05C+rTGGUEHBtZ+lxwwz8Y+APsPsMPekhbEEOjfvnM6/2gOKaG305iCbWciXgMwp+u56wG7lBMPSZF87wSWBde0JpJmGHZDZa+C0b53FoNFCeH8PEI1kn/n/65o0t8vtaRlZcDxSzP8c3RmiOzlap20Hc7kCkAcCIlqEV4UJyRf3qA3m0+lqKMhZNXN6YGfLJflP948jia/rilk61fKpMDp9Q3n0isHKHl+idJtLlZ1XSK6zLGwnXnqwePfE8EIOTX8BJbLvNwUrTcESVFQY5oBkRBG+WYd2Q69ZvcVO4NUb6xXFPHFrdekdRYGsuqxSCJ7bPqjptRwCebQcxnHSghdpnxV0tLKmoObY94qime+Wf5H7+E/dT5IuXjwRmy+GhBI8bEGhmKdDtY/ACXmoCv5cLUQCx3CJHY3zqodGYdQDnrp3sfreIS01D7Dp9ccaf9ICb/AeJsKXpvJcaH+jEyUgwJejNg/KnQZiCnvg9C+AY0D2x1fL8hXUvzixqbXZnrqMAXp+6JLJw+mdHsgf1xWEu52EfXa5QlZfeWJaIEZbjhODvIdIN9VeqjJxs0zTaMt7zRBnmxxGIEsZ+nWVBY7UIhHMRIkJ9TwIU6m+9wTQ29LbZ/WtwkdRNkBYNo3ORQnqpyL8TudXKsgUlq7A1mMUceOs="
  on:
    tags: true