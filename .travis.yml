addons:
  apt:
    packages:
    - realpath
language: python
python:
- "3.6"
services: docker
env:
  global:
  - GITHUB_USER=joeblackwaslike
  - GITHUB_ORG=joeblackwaslike
  - DOCKER_USER=joeblackwaslike
  - DOCKER_ORG=joeblackwaslike
  # DOCKER_PASS
  - secure: "D8bkjtrx6DAs1rQ1+Tyz3s6k56IMiwGPdI6/UFwvyqFDdLweOXkyzyD4UCRL2q9OfykB/QZu1vB3ChMwxF9wj3b4NQ23tHAXluNlii4RXZjONMtEBi3LPDO9T9jp9Ztk59+llqDCZVGRI9y0YwF/wJZF/6t2CGZrgmb5Kud3kcjYUkDMPG0kvua4HOG7FCQoX7D6NQrIQydIgJEpZ/EdZyHoAfL/LYzDyV055+dCMGkDuu4VLPBoqqdslgulvYdsl9g3OfZUXbtgTgMsrFxfOx/4gi1WZrFOnlAOPCo3ZdN/J4J4I5EYdY+1KKZk6C425Q4r3CUyQxUmEajc/PbzW2g1Q6O9OY2Tuw2lTkktS2YAUYyPgIfCPaXuDQECNyXxI7iLTlWWcg0Mhabpo4UJi1STgrAeh+0cOFAmLzVfx74kYZpiEVuukig8eH8sHhJnIs7A0ZD3wN5z0QLClZxbXUzKtuqTiLit7203TPu1muSxOuODUqYJCZpEBpkEh1gUTSPL4YwBAsd/jt9QeZS4EeYigMRYBFbbVs2+/j/7wlfg76+OKfu/I9WFouDZEP2my63wxfIQr6SlfSap8OqvbGiriXn5gX82nRU0j19HCf2hVD8d0yM3BcijMQBFxOqSu5pZS7CYZZR9W50KgePnV0PlsEzQxLq0sR4Nl0GAidg="
notifications:
  email:
    on_success: never
    on_failure: always
  slack:
    rooms:
    - secure: "mNMFPH1lEWuG7WwbrmzW88veEPWze4NI52GlTccvMTxr6MaWutyLkNlAAo8xjnPxWe7fcvZWO4XGF2tbcPPodpl7p4jW9sUz2/YwX24PvGKn3WeljL6JTX7KSNNx27Z8juHu/E6EXLo3ZkyMzZ2gA5ke/0NFRSdMmNWg0YXNSExgadk36YtATYL/uuY/EsbjH+Cayth/hoyrVZTKIWL8e7qTg+E0e+sA2HlXdwEkaz8EUR6xAnnpC2eOgK4veu3ipiz6OB9tjIF76yG/3SRHTOW7BdkkcIwbz8kac+kJT8Ep5/iw7V7Uyu2XrxmI07wKc/esyrC0jaMv3W6lkzRqHDzmNGiW6eifonB8CDyOtHOJdUVRu98Zq9EAN1B42jesIOJcJTcqDqbCguSI2JBzmcemtiArkkL24uQeRLS3G4yiJB1aBLAB99o7lAzkwLdoBuZF3Q63NiC7qrZEBWiAKVBg1MdhIoy/K92b0qSd5BCKMW9bK1GnKiWSTHlD6Zr6/nYt7jN5UfEhHVW406Qx1dxc7z8yQM7YVltQDhqX6n+ni88FDhsO75yFX3r8DlgRL7B0gpRfVoAgV78WPcCSK5RNHyJl6cipuGhPQxuAIrjF7Du8F97k4Ef+kSyOVKjkGUxTlGgHir68MjfqPMugYwiJGR5nTvOJfgLl5NMMlJo="
    on_success: always
    on_failure: always
before_install:
- source scripts/ci/environment.sh
- pip3 install pyinvoke

install: inv docker.build

script: inv test

after_success:
- ci-tag-build
- hub-push
- hub-update-readme

deploy:
  provider: pypi
  user: joeblackwaslike
  password:
    secure: "kcXWjpXNxUsk8lxfIpib2Enu59jWpxT8oZkPoHZy+PJJnKks5yGygnF3+NSolRWpJQsp9BZILttewOFaaVviAwjqNhZYphDXY7BNzTdo6NEMrzEESN6f+/JK06q7hLYD4Sf49oa9D0/2rk0Fg2YwEa7Ua6LfNP3ESVpJVHW6kgD78JuKvrrih4sAGqefXLMaF5C79+43QCqJfxJpbi26l6NjjCp4SAYQk2z8MSnbNf1GuoZMDd7TSGHf+/FTaynL2JxuykIAzcZEo4aP/+3YfUnQmg9rn4JBlqF2BWnA2UN3u8cTO/sx68lUgCCNSdUoB8K5mYYfltf3AKiO2xB38IQOgXysOKlDKOU42e6M2wFOitQc5Wmh51Q4y6n/gisNyHZIVP86lPa9uK5M9q5E0/cp+QeFgRTvqeRBMeZWnKtHP6SNUTsZUwtBj1tQrT06z8+uw14cNEGvX1CszNRnBmZurhWAZHEXykh3ppfr88G3WTTmUzwG+TSU8cLv6tKm27Yg3GxOPQiZAEyJfBB7m1MEAi0dNS9NdVTMNmW2QpBrqmoW5vjVpeirGXo4M4S2OXo+spMJ77Mm6JUnKoeyKrYUyvf2bcCdqQ0TR2Q9E+//omaLs4mlmzO07JrGAWxrn8PX9Tq8C0AsWQaCCXevLhzWjNlj5s18tUo5T3uG1W4="
  on:
    tags: true